### Framework

* [FastAPI](https://fastapi.tiangolo.com/)

### Setup (Docker)

See the `README.md` file in the parent directory.

###  Setup (Non-Docker)

Unless otherwise noted, commands should be run in the project directory's root (where this README is located).

##### Virtual Environment

[Virtual environments](https://docs.python.org/3/tutorial/venv.html) create an isolated Python environment to avoid dependency conflict issues with other Python projects.

*Create the virtual environment*

    python3 -m venv venv

*Activate the virtual environment*

    source venv/bin/activate

##### Install Dependencies
   
For initial install:

    pip install -r requirements.txt

For subsequent installs, you can use:

    pip-sync

Note that `pip-sync` will attempt to match `requirements.txt` exactly, including removing packages that do no appear in `requirements.txt`.

##### Start API server

With all the requirements installed, you should be able to start the server with this command:

    uvicorn main:app --reload

The `--reload` option will automatically update the server when the source code changes. By default, it'll be serving on [http://localhost:8000](http://localhost:8000). You can also see the FastAPI autogenerated documentation and API tester pages at [http://localhost:8000/docs](http://localhost:8000/docs) and [http://localhost:8000/redoc](http://localhost:8000/redoc).

##### Add Dependency

Add the dependency to `requirements.in`, in the same format as `requirements.txt`. If you do not specify a version limit, then it'll pull in the latest version.

After updating `requirements.in`, you need to update `requirements.txt` with this command:

    pip-compile

Then install the new package with:

    pip-sync

##### Upgrade Dependencies

To upgrade a dependency to the latest:

    pip-compile -P <DEPENDENCY_NAME>

To upgrade a dependency to a specific version:

    pip-compile -P <DEPENDENCY_NAME>==2.0.0

#### Troubleshooting

1. Compilation error caused by `wheel` when installing packages with `pip`
  This is caused by an outdated `setuptools`, version 39.0.1 was problematic for me, but updating to 41.0.0 seems to have fixed it. To upgrade `setuptools`:

        pip install --upgrade setuptools

  This can also be caused by an outdated `pip`. You can upgrade with:

        pip install --upgrade pip

  After upgrading, you will want to reinstall the package that threw the compilation error, this will need to be done with `pip` and not `pip-sync`:

        pip install --force-reinstall <PACKAGE_NAME>
